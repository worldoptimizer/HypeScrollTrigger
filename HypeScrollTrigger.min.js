/*
 Hype ScrollTrigger v1.0.1
 Integrates GSAP ScrollTrigger with Tumult Hype for scroll-based animations and interactions.
 Copyright (2025) Max Ziebell, (https://maxziebell.de). MIT-license
*/
'use strict';!1==="HypeScrollTrigger"in window&&(window.HypeScrollTrigger=function(){function P(e,b,c,a={}){u.has(e)||u.set(e,{timelineName:b,api:c,currentProgress:0,targetProgress:0,animating:!1,smoothFactor:a.smoothFactor||n.options.smoothFactor,enabled:!1!==a.smooth})}function D(e,b){const c=u.get(e);if(c&&c.enabled){var a=ScrollTrigger.getAll().find(h=>{const g=c.api.currentSceneId?c.api.currentSceneId():null;return h.trigger&&h.trigger.id===g});if(.5<Math.abs(b-c.currentProgress)||a&&a.isReverted){if(c.currentProgress=
b,c.targetProgress=b,c.animating=!1,c.timelineName)try{const h=c.api.durationForTimelineNamed(c.timelineName);0!==h&&c.api.goToTimeInTimelineNamed(b*h,c.timelineName)}catch(h){console.error("\u274c Error updating timeline:",h)}}else c.targetProgress=b,c.animating||(c.animating=!0,J(e))}else if(c&&c.timelineName)try{a=c.api.durationForTimelineNamed(c.timelineName),0!==a&&c.api.goToTimeInTimelineNamed(b*a,c.timelineName)}catch(h){console.error("\u274c Error updating timeline:",h)}}function J(e){const b=
u.get(e);if(b)if(.001<Math.abs(b.targetProgress-b.currentProgress)){b.currentProgress+=(b.targetProgress-b.currentProgress)*b.smoothFactor;if(b.timelineName){var c=b.api.durationForTimelineNamed(b.timelineName);0!==c&&b.api.goToTimeInTimelineNamed(b.currentProgress*c,b.timelineName)}requestAnimationFrame(()=>J(e))}else b.animating=!1,b.currentProgress=b.targetProgress,b.timelineName&&(c=b.api.durationForTimelineNamed(b.timelineName),0!==c&&b.api.goToTimeInTimelineNamed(b.currentProgress*c,b.timelineName))}
function E(e){return e?n[e]:n}function Q(e,b){for(;b&&b!==document;){const c=e.getSymbolInstanceById(b.id);if(c)return c;b=b.parentNode}return null}function K(e,b,c,a){try{const r=e.currentSceneId(),F=!1!=="HypeActionEvents"in window,z=a.scrollName||c;a=Object.assign({},n.options,a);const v=document.getElementById(r),A=a.horizontal||!1;var h=A?"width":"height";const R=window;var g=b.getBoundingClientRect()[h],l=v.getBoundingClientRect();const L=b.getBoundingClientRect(),M=A?L.left-l.left:L.top-l.top;
let p=void 0!==a.offset?a.offset:M,m=void 0!==a.duration?a.duration:g,w=void 0!==a.triggerHook?a.triggerHook:.5;const N=Q(e,b);h=N?N:e;l=b;if(a.pin){const d=b.closest(".hype-gsap-scroll-pin-wrapper");if(d)l=d;else{const f=document.createElement("div");f.classList.add("hype-gsap-scroll-pin-wrapper");b.parentNode.insertBefore(f,b);f.appendChild(b);l=f}}"string"===typeof m&&(m=m.endsWith(A?"vw":"vh")?parseInt(m)+"%":m.endsWith("%")?parseFloat(m)/100*g:parseFloat(m));"string"===typeof p&&(p=p.endsWith("%")?
parseFloat(p)/100*g+M:parseFloat(p));if(F){const d=a.scrollCode,f=a.offsetCode||d,k=a.durationCode||d,O=a.triggerHookCode||d;g={offset:p,duration:m,triggerHook:w};f&&(p=e.triggerAction("return "+f,{element:b,scope:g,event:Object.assign(g,{type:"offset"})})??p);k&&(m=e.triggerAction("return "+k,{element:b,scope:g,event:Object.assign(g,{type:"duration"})})??m);O&&(w=e.triggerAction("return "+O,{element:b,scope:g,event:Object.assign(g,{type:"triggerHook"})})??w)}const x=`${r}_${b.id}_${Date.now()}`;
if(c&&h&&h.durationForTimelineNamed){const d=h.durationForTimelineNamed(c);void 0!==d&&null!==d?(a.reset&&(h.pauseTimelineNamed(c),h.goToTimeInTimelineNamed(0,c)),P(x,c,h,{smooth:a.smooth,smoothFactor:a.smoothFactor})):console.warn("\u26a0\ufe0f Timeline '"+c+"' not found in Hype document")}function B(d,f){var k=f.scrollDirection.charAt(0).toUpperCase()+f.scrollDirection.slice(1).toLowerCase();f=z?z+" ":"";k=f+d+" "+k;d=f+d;e.triggerCustomBehaviorNamed(k);e.triggerCustomBehaviorNamed(d);n.logBehavior&&
(console.log(d),console.log(k))}function C(d,f){if(F){const k=a.scrollCode;(d=a[d.toLowerCase()+"Code"]||k)&&e.triggerAction(d,{element:b,event:f})}}function y(d,f,k=null){d={type:d,scrollDirection:f,target:b,currentTarget:b};null!==k&&(d.progress=k);return d}const t={trigger:v,scroller:R,start:`top+=${p} ${`${100*w}%`}`,end:0===m?`top+=${p} ${`${100*w}%`}`:`+=${m}`,horizontal:A,pin:a.pin?l:!1,pinSpacing:!1,markers:n.addIndicators||a.addIndicators?{startColor:a.indicatorColor||"grey",endColor:a.indicatorColor||
"grey",fontSize:"12px",fontWeight:"bold",indent:10}:!1,scrub:!1,toggleActions:"play none none reverse",invalidateOnRefresh:!0};if(a.hasOwnProperty("properties")){const d="string"===typeof a.properties?a.properties||"scroll":"scroll",f="scroll"===d?b:document.getElementById(e.documentId());f.style.setProperty("--"+d+"-duration",m);f.style.setProperty("--"+d+"-offset",p);f.style.setProperty("--"+d+"-trigger-hook",w);f.style.setProperty("--"+d+"-progress",0)}t.onUpdate=d=>{const f=d.progress;if(a.hasOwnProperty("properties")){var k=
"string"===typeof a.properties?a.properties||"scroll":"scroll";("scroll"===k?b:document.getElementById(e.documentId())).style.setProperty("--"+k+"-progress",f)}c&&D(x,f);F&&(k=a.scrollCode,k=a.progressCode||k)&&(d=y("progress",0<d.direction?"FORWARD":"REVERSE",f),e.triggerAction(k,{element:b,event:d}))};t.onRefresh=d=>{if(a.hasOwnProperty("properties")){const f="string"===typeof a.properties?a.properties||"scroll":"scroll";("scroll"===f?b:document.getElementById(e.documentId())).style.setProperty("--"+
f+"-progress",d.progress)}c&&D(x,d.progress)};const G=z&&n.behavior.enter;if(G||a.enterCode)t.onEnter=()=>{const d=y("enter","FORWARD");a.elementClass&&b.classList.add(a.elementClass);a.sceneClass&&v.classList.add(a.sceneClass);G&&B("Enter",d);a.enterCode&&C("Enter",d)},t.onEnterBack=()=>{const d=y("enter","REVERSE");a.elementClass&&b.classList.add(a.elementClass);a.sceneClass&&v.classList.add(a.sceneClass);G&&B("Enter",d);a.enterCode&&C("Enter",d)};const H=z&&n.behavior.leave;if(H||a.leaveCode)t.onLeave=
()=>{const d=y("leave","FORWARD");a.elementClass&&b.classList.remove(a.elementClass);a.sceneClass&&v.classList.remove(a.sceneClass);H&&B("Leave",d);a.leaveCode&&C("Leave",d)},t.onLeaveBack=()=>{const d=y("leave","REVERSE");a.elementClass&&b.classList.remove(a.elementClass);a.sceneClass&&v.classList.remove(a.sceneClass);H&&B("Leave",d);a.leaveCode&&C("Leave",d)};const I=ScrollTrigger.create(t);q[r]||(q[r]=[]);q[r].push({trigger:I,id:x});if(c&&h&&h.durationForTimelineNamed){const d=I.progress,f=h.durationForTimelineNamed(c);
0!==f&&void 0!==f&&D(x,d)}return I}catch(r){return console.error("\u274c Error in addScrollTimeline:",r),console.error("Stack trace:",r.stack),null}}if(window.gsap&&window.ScrollTrigger){gsap.registerPlugin(ScrollTrigger);var q={},u=new Map,n={options:{triggerHook:.5,pin:!1,reset:!0,indicatorColor:"grey",smooth:!0,smoothFactor:.15},behavior:{enter:!0,leave:!0},timelineName:"Main Timeline",logBehavior:!1,addIndicators:!1,autoProperties:!0};!1==="HYPE_eventListeners"in window&&(window.HYPE_eventListeners=
[]);window.HYPE_eventListeners.push({type:"HypeDocumentLoad",callback:function(e,b,c){e.addScrollTimeline=function(a,h,g){return K(e,a,h,g)};ScrollTrigger.config({limitCallbacks:!0,syncInterval:40})}});window.HYPE_eventListeners.push({type:"HypeSceneLoad",callback:function(e,b){const c=!1!=="HypeActionEvents"in window;b.querySelectorAll("[data-scroll-magic],[data-scroll-timeline],[data-scroll-pin],[data-scroll-properties],[data-scroll-element-class],[data-scroll-scene-class]"+(c?",[data-scroll-action],[data-scroll-progress-action],[data-scroll-enter-action],[data-scroll-leave-action]":
"")).forEach(function(a,h){h=a.hasAttribute("data-scroll-timeline")?a.getAttribute("data-scroll-timeline")?a.getAttribute("data-scroll-timeline").split(",").map(l=>l.trim()):[n.timelineName]:[null];const g={pin:a.hasAttribute("data-scroll-pin"),offset:a.getAttribute("data-scroll-offset")||void 0,duration:a.getAttribute("data-scroll-duration")||void 0,triggerHook:a.getAttribute("data-scroll-trigger")?parseFloat(a.getAttribute("data-scroll-trigger")):void 0,reset:"false"===a.getAttribute("data-scroll-reset")?
!1:!0,horizontal:a.hasAttribute("data-scroll-horizontal"),smooth:a.hasAttribute("data-scroll-smooth")?"false"!==a.getAttribute("data-scroll-smooth"):void 0,smoothFactor:a.getAttribute("data-scroll-smooth-factor")?parseFloat(a.getAttribute("data-scroll-smooth-factor")):void 0};a.hasAttribute("data-scroll-name")&&(g.scrollName=a.getAttribute("data-scroll-name"));c&&(a.hasAttribute("data-scroll-action")&&(g.scrollCode=a.getAttribute("data-scroll-action")),a.hasAttribute("data-scroll-offset-action")&&
(g.offsetCode=a.getAttribute("data-scroll-offset-action")),a.hasAttribute("data-scroll-duration-action")&&(g.durationCode=a.getAttribute("data-scroll-duration-action")),a.hasAttribute("data-scroll-trigger-action")&&(g.triggerHookCode=a.getAttribute("data-scroll-trigger-action")),a.hasAttribute("data-scroll-progress-action")&&(g.progressCode=a.getAttribute("data-scroll-progress-action")),a.hasAttribute("data-scroll-enter-action")&&(g.enterCode=a.getAttribute("data-scroll-enter-action")),a.hasAttribute("data-scroll-leave-action")&&
(g.leaveCode=a.getAttribute("data-scroll-leave-action")));a.hasAttribute("data-scroll-element-class")&&(g.elementClass=a.getAttribute("data-scroll-element-class"));a.hasAttribute("data-scroll-scene-class")&&(g.sceneClass=a.getAttribute("data-scroll-scene-class"));if(a.hasAttribute("data-scroll-properties")){const l=a.getAttribute("data-scroll-properties");E("autoProperties")&&"false"==l||(g.properties=l)}else E("autoProperties")&&(g.properties=!0);a.getAttribute("data-indicator-color")&&(g.indicatorColor=
a.getAttribute("data-indicator-color"));a.hasAttribute("data-indicator-force")&&(g.addIndicators=!0);h.forEach(l=>{K(e,a,l,g)})});ScrollTrigger.refresh()}});window.HYPE_eventListeners.push({type:"HypeSceneUnload",callback:function(e,b){e=b.id;q[e]&&q[e].forEach(({id:c})=>{u.delete(c)});q[e]&&(q[e].forEach(({trigger:c})=>{c&&c.kill()}),q[e]=[]);ScrollTrigger.refresh()}});return{version:"1.0.1",setDefault:function(e,b){"object"==typeof e?n=e:n[e]=b},getDefault:E,refresh:()=>{ScrollTrigger.refresh()},
getTriggersForScene:e=>q[e]||[],debug:()=>({gsapVersion:gsap.version,scrollTriggerVersion:ScrollTrigger.version,triggers:q,scrollTriggers:ScrollTrigger.getAll(),timelineStates:u})}}console.error("\u274c HypeScrollTrigger: GSAP and ScrollTrigger are required but not available. Please include them before this script.")}());
