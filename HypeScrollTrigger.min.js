/*
 Hype ScrollTrigger v1.0.0
 Integrates GSAP ScrollTrigger with Tumult Hype for scroll-based animations and interactions.
 Copyright (2024) Max Ziebell, (https://maxziebell.de). MIT-license
 Rewritten from Hype ScrollMagic to use GSAP ScrollTrigger for better performance and modern features.
*/
'use strict';!1==="HypeScrollTrigger"in window&&(window.HypeScrollTrigger=function(){function P(d,b,e,a={}){u.has(d)||u.set(d,{timelineName:b,api:e,currentProgress:0,targetProgress:0,animating:!1,smoothFactor:a.smoothFactor||n.options.smoothFactor,enabled:!1!==a.smooth})}function D(d,b){const e=u.get(d);if(e&&e.enabled)e.targetProgress=b,e.animating||(e.animating=!0,J(d));else if(e&&e.timelineName)try{const a=e.api.durationForTimelineNamed(e.timelineName);0!==a&&e.api.goToTimeInTimelineNamed(b*a,
e.timelineName)}catch(a){console.error("\u274c Error updating timeline:",a)}}function J(d){const b=u.get(d);if(b)if(.001<Math.abs(b.targetProgress-b.currentProgress)){b.currentProgress+=(b.targetProgress-b.currentProgress)*b.smoothFactor;if(b.timelineName){var e=b.api.durationForTimelineNamed(b.timelineName);0!==e&&b.api.goToTimeInTimelineNamed(b.currentProgress*e,b.timelineName)}requestAnimationFrame(()=>J(d))}else b.animating=!1,b.currentProgress=b.targetProgress,b.timelineName&&(e=b.api.durationForTimelineNamed(b.timelineName),
0!==e&&b.api.goToTimeInTimelineNamed(b.currentProgress*e,b.timelineName))}function E(d){return d?n[d]:n}function Q(d,b){for(;b&&b!==document;){const e=d.getSymbolInstanceById(b.id);if(e)return e;b=b.parentNode}return null}function K(d,b,e,a){try{const r=d.currentSceneId(),F=!1!=="HypeActionEvents"in window,z=a.scrollName||e;a=Object.assign({},n.options,a);const v=document.getElementById(r),A=a.horizontal||!1;var k=A?"width":"height";const R=window;var f=b.getBoundingClientRect()[k],m=v.getBoundingClientRect();
const L=b.getBoundingClientRect(),M=A?L.left-m.left:L.top-m.top;let p=void 0!==a.offset?a.offset:M,l=void 0!==a.duration?a.duration:f,w=void 0!==a.triggerHook?a.triggerHook:.5;const N=Q(d,b);k=N?N:d;m=b;if(a.pin){const c=document.createElement("div");c.classList.add("hype-gsap-scroll-pin-wrapper");b.parentNode.insertBefore(c,b);c.appendChild(b);m=c}"string"===typeof l&&(l=l.endsWith(A?"vw":"vh")?parseInt(l)+"%":l.endsWith("%")?parseFloat(l)/100*f:parseFloat(l));"string"===typeof p&&(p=p.endsWith("%")?
parseFloat(p)/100*f+M:parseFloat(p));if(F){const c=a.scrollCode,g=a.offsetCode||c,h=a.durationCode||c,O=a.triggerHookCode||c;f={offset:p,duration:l,triggerHook:w};g&&(p=d.triggerAction("return "+g,{element:b,scope:f,event:Object.assign(f,{type:"offset"})})??p);h&&(l=d.triggerAction("return "+h,{element:b,scope:f,event:Object.assign(f,{type:"duration"})})??l);O&&(w=d.triggerAction("return "+O,{element:b,scope:f,event:Object.assign(f,{type:"triggerHook"})})??w)}const x=`${r}_${b.id}_${Date.now()}`;
if(e&&k&&k.durationForTimelineNamed){const c=k.durationForTimelineNamed(e);void 0!==c&&null!==c?(a.reset&&(k.pauseTimelineNamed(e),k.goToTimeInTimelineNamed(0,e)),P(x,e,k,{smooth:a.smooth,smoothFactor:a.smoothFactor})):console.warn("\u26a0\ufe0f Timeline '"+e+"' not found in Hype document")}function B(c,g){var h=g.scrollDirection.charAt(0).toUpperCase()+g.scrollDirection.slice(1).toLowerCase();g=z?z+" ":"";h=g+c+" "+h;c=g+c;d.triggerCustomBehaviorNamed(h);d.triggerCustomBehaviorNamed(c);n.logBehavior&&
(console.log(c),console.log(h))}function C(c,g){if(F){const h=a.scrollCode;(c=a[c.toLowerCase()+"Code"]||h)&&d.triggerAction(c,{element:b,event:g})}}function y(c,g,h=null){c={type:c,scrollDirection:g,target:b,currentTarget:b};null!==h&&(c.progress=h);return c}const t={trigger:v,scroller:R,start:`top+=${p} ${`${100*w}%`}`,end:0===l?`top+=${p} ${`${100*w}%`}`:`+=${l}`,horizontal:A,pin:a.pin?m:!1,pinSpacing:!1,markers:n.addIndicators||a.addIndicators?{startColor:a.indicatorColor||"grey",endColor:a.indicatorColor||
"grey",fontSize:"12px",fontWeight:"bold",indent:10}:!1,scrub:!1,toggleActions:"play none none reverse",invalidateOnRefresh:!0};if(a.hasOwnProperty("properties")){const c="string"===typeof a.properties?a.properties||"scroll":"scroll",g="scroll"===c?b:document.getElementById(d.documentId());g.style.setProperty("--"+c+"-duration",l);g.style.setProperty("--"+c+"-offset",p);g.style.setProperty("--"+c+"-trigger-hook",w);g.style.setProperty("--"+c+"-progress",0)}t.onUpdate=c=>{const g=c.progress;if(a.hasOwnProperty("properties")){var h=
"string"===typeof a.properties?a.properties||"scroll":"scroll";("scroll"===h?b:document.getElementById(d.documentId())).style.setProperty("--"+h+"-progress",g)}e&&D(x,g);F&&(h=a.scrollCode,h=a.progressCode||h)&&(c=y("progress",0<c.direction?"FORWARD":"REVERSE",g),d.triggerAction(h,{element:b,event:c}))};t.onRefresh=c=>{if(a.hasOwnProperty("properties")){const g="string"===typeof a.properties?a.properties||"scroll":"scroll";("scroll"===g?b:document.getElementById(d.documentId())).style.setProperty("--"+
g+"-progress",c.progress)}e&&D(x,c.progress)};const G=z&&n.behavior.enter;if(G||a.enterCode)t.onEnter=()=>{const c=y("enter","FORWARD");a.elementClass&&b.classList.add(a.elementClass);a.sceneClass&&v.classList.add(a.sceneClass);G&&B("Enter",c);a.enterCode&&C("Enter",c)},t.onEnterBack=()=>{const c=y("enter","REVERSE");a.elementClass&&b.classList.add(a.elementClass);a.sceneClass&&v.classList.add(a.sceneClass);G&&B("Enter",c);a.enterCode&&C("Enter",c)};const H=z&&n.behavior.leave;if(H||a.leaveCode)t.onLeave=
()=>{const c=y("leave","FORWARD");a.elementClass&&b.classList.remove(a.elementClass);a.sceneClass&&v.classList.remove(a.sceneClass);H&&B("Leave",c);a.leaveCode&&C("Leave",c)},t.onLeaveBack=()=>{const c=y("leave","REVERSE");a.elementClass&&b.classList.remove(a.elementClass);a.sceneClass&&v.classList.remove(a.sceneClass);H&&B("Leave",c);a.leaveCode&&C("Leave",c)};const I=ScrollTrigger.create(t);q[r]||(q[r]=[]);q[r].push({trigger:I,id:x});if(e&&k&&k.durationForTimelineNamed){const c=I.progress,g=k.durationForTimelineNamed(e);
0!==g&&void 0!==g&&D(x,c)}return I}catch(r){return console.error("\u274c Error in addScrollTimeline:",r),console.error("Stack trace:",r.stack),null}}if(window.gsap&&window.ScrollTrigger){gsap.registerPlugin(ScrollTrigger);var q={},u=new Map,n={options:{triggerHook:.5,pin:!1,reset:!0,indicatorColor:"grey",smooth:!0,smoothFactor:.15},behavior:{enter:!0,leave:!0},timelineName:"Main Timeline",logBehavior:!1,addIndicators:!1,autoProperties:!0};!1==="HYPE_eventListeners"in window&&(window.HYPE_eventListeners=
[]);window.HYPE_eventListeners.push({type:"HypeDocumentLoad",callback:function(d,b,e){d.addScrollTimeline=function(a,k,f){return K(d,a,k,f)};ScrollTrigger.config({limitCallbacks:!0,syncInterval:40})}});window.HYPE_eventListeners.push({type:"HypeSceneLoad",callback:function(d,b){const e=!1!=="HypeActionEvents"in window;b.querySelectorAll("[data-scroll-magic],[data-scroll-timeline],[data-scroll-pin],[data-scroll-properties],[data-scroll-element-class],[data-scroll-scene-class]"+(e?",[data-scroll-action],[data-scroll-progress-action],[data-scroll-enter-action],[data-scroll-leave-action]":
"")).forEach(function(a,k){k=a.hasAttribute("data-scroll-timeline")?a.getAttribute("data-scroll-timeline")?a.getAttribute("data-scroll-timeline").split(",").map(m=>m.trim()):[n.timelineName]:[null];const f={pin:a.hasAttribute("data-scroll-pin"),offset:a.getAttribute("data-scroll-offset")||void 0,duration:a.getAttribute("data-scroll-duration")||void 0,triggerHook:a.getAttribute("data-scroll-trigger")?parseFloat(a.getAttribute("data-scroll-trigger")):void 0,reset:"false"===a.getAttribute("data-scroll-reset")?
!1:!0,horizontal:a.hasAttribute("data-scroll-horizontal"),smooth:a.hasAttribute("data-scroll-smooth")?"false"!==a.getAttribute("data-scroll-smooth"):void 0,smoothFactor:a.getAttribute("data-scroll-smooth-factor")?parseFloat(a.getAttribute("data-scroll-smooth-factor")):void 0};a.hasAttribute("data-scroll-name")&&(f.scrollName=a.getAttribute("data-scroll-name"));e&&(a.hasAttribute("data-scroll-action")&&(f.scrollCode=a.getAttribute("data-scroll-action")),a.hasAttribute("data-scroll-offset-action")&&
(f.offsetCode=a.getAttribute("data-scroll-offset-action")),a.hasAttribute("data-scroll-duration-action")&&(f.durationCode=a.getAttribute("data-scroll-duration-action")),a.hasAttribute("data-scroll-trigger-action")&&(f.triggerHookCode=a.getAttribute("data-scroll-trigger-action")),a.hasAttribute("data-scroll-progress-action")&&(f.progressCode=a.getAttribute("data-scroll-progress-action")),a.hasAttribute("data-scroll-enter-action")&&(f.enterCode=a.getAttribute("data-scroll-enter-action")),a.hasAttribute("data-scroll-leave-action")&&
(f.leaveCode=a.getAttribute("data-scroll-leave-action")));a.hasAttribute("data-scroll-element-class")&&(f.elementClass=a.getAttribute("data-scroll-element-class"));a.hasAttribute("data-scroll-scene-class")&&(f.sceneClass=a.getAttribute("data-scroll-scene-class"));if(a.hasAttribute("data-scroll-properties")){const m=a.getAttribute("data-scroll-properties");E("autoProperties")&&"false"==m||(f.properties=m)}else E("autoProperties")&&(f.properties=!0);a.getAttribute("data-indicator-color")&&(f.indicatorColor=
a.getAttribute("data-indicator-color"));a.hasAttribute("data-indicator-force")&&(f.addIndicators=!0);k.forEach(m=>{K(d,a,m,f)})});ScrollTrigger.refresh()}});window.HYPE_eventListeners.push({type:"HypeSceneUnload",callback:function(d,b){d=b.id;q[d]&&q[d].forEach(({id:e})=>{u.delete(e)});q[d]&&(q[d].forEach(({trigger:e})=>{e&&e.kill()}),q[d]=[]);ScrollTrigger.refresh()}});return{version:"1.0.0",setDefault:function(d,b){"object"==typeof d?n=d:n[d]=b},getDefault:E,refresh:()=>{ScrollTrigger.refresh()},
getTriggersForScene:d=>q[d]||[],debug:()=>({gsapVersion:gsap.version,scrollTriggerVersion:ScrollTrigger.version,triggers:q,scrollTriggers:ScrollTrigger.getAll(),timelineStates:u})}}console.error("\u274c HypeScrollTrigger: GSAP and ScrollTrigger are required but not available. Please include them before this script.")}());
