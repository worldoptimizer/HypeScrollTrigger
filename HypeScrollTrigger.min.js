/*
 Hype ScrollTrigger v1.0.1
 Integrates GSAP ScrollTrigger with Tumult Hype for scroll-based animations and interactions.
 Copyright (2024) Max Ziebell, (https://maxziebell.de). MIT-license
*/
'use strict';!1==="HypeScrollTrigger"in window&&(window.HypeScrollTrigger=function(){function P(d,b,e,a={}){u.has(d)||u.set(d,{timelineName:b,api:e,currentProgress:0,targetProgress:0,animating:!1,smoothFactor:a.smoothFactor||n.options.smoothFactor,enabled:!1!==a.smooth})}function D(d,b){const e=u.get(d);if(e&&e.enabled)e.targetProgress=b,e.animating||(e.animating=!0,J(d));else if(e&&e.timelineName)try{const a=e.api.durationForTimelineNamed(e.timelineName);0!==a&&e.api.goToTimeInTimelineNamed(b*a,
e.timelineName)}catch(a){console.error("\u274c Error updating timeline:",a)}}function J(d){const b=u.get(d);if(b)if(.001<Math.abs(b.targetProgress-b.currentProgress)){b.currentProgress+=(b.targetProgress-b.currentProgress)*b.smoothFactor;if(b.timelineName){var e=b.api.durationForTimelineNamed(b.timelineName);0!==e&&b.api.goToTimeInTimelineNamed(b.currentProgress*e,b.timelineName)}requestAnimationFrame(()=>J(d))}else b.animating=!1,b.currentProgress=b.targetProgress,b.timelineName&&(e=b.api.durationForTimelineNamed(b.timelineName),
0!==e&&b.api.goToTimeInTimelineNamed(b.currentProgress*e,b.timelineName))}function E(d){return d?n[d]:n}function Q(d,b){for(;b&&b!==document;){const e=d.getSymbolInstanceById(b.id);if(e)return e;b=b.parentNode}return null}function K(d,b,e,a){try{const r=d.currentSceneId(),F=!1!=="HypeActionEvents"in window,z=a.scrollName||e;a=Object.assign({},n.options,a);const v=document.getElementById(r),A=a.horizontal||!1;var k=A?"width":"height";const R=window;var g=b.getBoundingClientRect()[k],l=v.getBoundingClientRect();
const L=b.getBoundingClientRect(),M=A?L.left-l.left:L.top-l.top;let p=void 0!==a.offset?a.offset:M,m=void 0!==a.duration?a.duration:g,w=void 0!==a.triggerHook?a.triggerHook:.5;const N=Q(d,b);k=N?N:d;l=b;if(a.pin){const c=b.closest(".hype-gsap-scroll-pin-wrapper");if(c)l=c;else{const f=document.createElement("div");f.classList.add("hype-gsap-scroll-pin-wrapper");b.parentNode.insertBefore(f,b);f.appendChild(b);l=f}}"string"===typeof m&&(m=m.endsWith(A?"vw":"vh")?parseInt(m)+"%":m.endsWith("%")?parseFloat(m)/
100*g:parseFloat(m));"string"===typeof p&&(p=p.endsWith("%")?parseFloat(p)/100*g+M:parseFloat(p));if(F){const c=a.scrollCode,f=a.offsetCode||c,h=a.durationCode||c,O=a.triggerHookCode||c;g={offset:p,duration:m,triggerHook:w};f&&(p=d.triggerAction("return "+f,{element:b,scope:g,event:Object.assign(g,{type:"offset"})})??p);h&&(m=d.triggerAction("return "+h,{element:b,scope:g,event:Object.assign(g,{type:"duration"})})??m);O&&(w=d.triggerAction("return "+O,{element:b,scope:g,event:Object.assign(g,{type:"triggerHook"})})??
w)}const x=`${r}_${b.id}_${Date.now()}`;if(e&&k&&k.durationForTimelineNamed){const c=k.durationForTimelineNamed(e);void 0!==c&&null!==c?(a.reset&&(k.pauseTimelineNamed(e),k.goToTimeInTimelineNamed(0,e)),P(x,e,k,{smooth:a.smooth,smoothFactor:a.smoothFactor})):console.warn("\u26a0\ufe0f Timeline '"+e+"' not found in Hype document")}function B(c,f){var h=f.scrollDirection.charAt(0).toUpperCase()+f.scrollDirection.slice(1).toLowerCase();f=z?z+" ":"";h=f+c+" "+h;c=f+c;d.triggerCustomBehaviorNamed(h);d.triggerCustomBehaviorNamed(c);
n.logBehavior&&(console.log(c),console.log(h))}function C(c,f){if(F){const h=a.scrollCode;(c=a[c.toLowerCase()+"Code"]||h)&&d.triggerAction(c,{element:b,event:f})}}function y(c,f,h=null){c={type:c,scrollDirection:f,target:b,currentTarget:b};null!==h&&(c.progress=h);return c}const t={trigger:v,scroller:R,start:`top+=${p} ${`${100*w}%`}`,end:0===m?`top+=${p} ${`${100*w}%`}`:`+=${m}`,horizontal:A,pin:a.pin?l:!1,pinSpacing:!1,markers:n.addIndicators||a.addIndicators?{startColor:a.indicatorColor||"grey",
endColor:a.indicatorColor||"grey",fontSize:"12px",fontWeight:"bold",indent:10}:!1,scrub:!1,toggleActions:"play none none reverse",invalidateOnRefresh:!0};if(a.hasOwnProperty("properties")){const c="string"===typeof a.properties?a.properties||"scroll":"scroll",f="scroll"===c?b:document.getElementById(d.documentId());f.style.setProperty("--"+c+"-duration",m);f.style.setProperty("--"+c+"-offset",p);f.style.setProperty("--"+c+"-trigger-hook",w);f.style.setProperty("--"+c+"-progress",0)}t.onUpdate=c=>
{const f=c.progress;if(a.hasOwnProperty("properties")){var h="string"===typeof a.properties?a.properties||"scroll":"scroll";("scroll"===h?b:document.getElementById(d.documentId())).style.setProperty("--"+h+"-progress",f)}e&&D(x,f);F&&(h=a.scrollCode,h=a.progressCode||h)&&(c=y("progress",0<c.direction?"FORWARD":"REVERSE",f),d.triggerAction(h,{element:b,event:c}))};t.onRefresh=c=>{if(a.hasOwnProperty("properties")){const f="string"===typeof a.properties?a.properties||"scroll":"scroll";("scroll"===f?
b:document.getElementById(d.documentId())).style.setProperty("--"+f+"-progress",c.progress)}e&&D(x,c.progress)};const G=z&&n.behavior.enter;if(G||a.enterCode)t.onEnter=()=>{const c=y("enter","FORWARD");a.elementClass&&b.classList.add(a.elementClass);a.sceneClass&&v.classList.add(a.sceneClass);G&&B("Enter",c);a.enterCode&&C("Enter",c)},t.onEnterBack=()=>{const c=y("enter","REVERSE");a.elementClass&&b.classList.add(a.elementClass);a.sceneClass&&v.classList.add(a.sceneClass);G&&B("Enter",c);a.enterCode&&
C("Enter",c)};const H=z&&n.behavior.leave;if(H||a.leaveCode)t.onLeave=()=>{const c=y("leave","FORWARD");a.elementClass&&b.classList.remove(a.elementClass);a.sceneClass&&v.classList.remove(a.sceneClass);H&&B("Leave",c);a.leaveCode&&C("Leave",c)},t.onLeaveBack=()=>{const c=y("leave","REVERSE");a.elementClass&&b.classList.remove(a.elementClass);a.sceneClass&&v.classList.remove(a.sceneClass);H&&B("Leave",c);a.leaveCode&&C("Leave",c)};const I=ScrollTrigger.create(t);q[r]||(q[r]=[]);q[r].push({trigger:I,
id:x});if(e&&k&&k.durationForTimelineNamed){const c=I.progress,f=k.durationForTimelineNamed(e);0!==f&&void 0!==f&&D(x,c)}return I}catch(r){return console.error("\u274c Error in addScrollTimeline:",r),console.error("Stack trace:",r.stack),null}}if(window.gsap&&window.ScrollTrigger){gsap.registerPlugin(ScrollTrigger);var q={},u=new Map,n={options:{triggerHook:.5,pin:!1,reset:!0,indicatorColor:"grey",smooth:!0,smoothFactor:.15},behavior:{enter:!0,leave:!0},timelineName:"Main Timeline",logBehavior:!1,
addIndicators:!1,autoProperties:!0};!1==="HYPE_eventListeners"in window&&(window.HYPE_eventListeners=[]);window.HYPE_eventListeners.push({type:"HypeDocumentLoad",callback:function(d,b,e){d.addScrollTimeline=function(a,k,g){return K(d,a,k,g)};ScrollTrigger.config({limitCallbacks:!0,syncInterval:40})}});window.HYPE_eventListeners.push({type:"HypeSceneLoad",callback:function(d,b){const e=!1!=="HypeActionEvents"in window;b.querySelectorAll("[data-scroll-magic],[data-scroll-timeline],[data-scroll-pin],[data-scroll-properties],[data-scroll-element-class],[data-scroll-scene-class]"+
(e?",[data-scroll-action],[data-scroll-progress-action],[data-scroll-enter-action],[data-scroll-leave-action]":"")).forEach(function(a,k){k=a.hasAttribute("data-scroll-timeline")?a.getAttribute("data-scroll-timeline")?a.getAttribute("data-scroll-timeline").split(",").map(l=>l.trim()):[n.timelineName]:[null];const g={pin:a.hasAttribute("data-scroll-pin"),offset:a.getAttribute("data-scroll-offset")||void 0,duration:a.getAttribute("data-scroll-duration")||void 0,triggerHook:a.getAttribute("data-scroll-trigger")?
parseFloat(a.getAttribute("data-scroll-trigger")):void 0,reset:"false"===a.getAttribute("data-scroll-reset")?!1:!0,horizontal:a.hasAttribute("data-scroll-horizontal"),smooth:a.hasAttribute("data-scroll-smooth")?"false"!==a.getAttribute("data-scroll-smooth"):void 0,smoothFactor:a.getAttribute("data-scroll-smooth-factor")?parseFloat(a.getAttribute("data-scroll-smooth-factor")):void 0};a.hasAttribute("data-scroll-name")&&(g.scrollName=a.getAttribute("data-scroll-name"));e&&(a.hasAttribute("data-scroll-action")&&
(g.scrollCode=a.getAttribute("data-scroll-action")),a.hasAttribute("data-scroll-offset-action")&&(g.offsetCode=a.getAttribute("data-scroll-offset-action")),a.hasAttribute("data-scroll-duration-action")&&(g.durationCode=a.getAttribute("data-scroll-duration-action")),a.hasAttribute("data-scroll-trigger-action")&&(g.triggerHookCode=a.getAttribute("data-scroll-trigger-action")),a.hasAttribute("data-scroll-progress-action")&&(g.progressCode=a.getAttribute("data-scroll-progress-action")),a.hasAttribute("data-scroll-enter-action")&&
(g.enterCode=a.getAttribute("data-scroll-enter-action")),a.hasAttribute("data-scroll-leave-action")&&(g.leaveCode=a.getAttribute("data-scroll-leave-action")));a.hasAttribute("data-scroll-element-class")&&(g.elementClass=a.getAttribute("data-scroll-element-class"));a.hasAttribute("data-scroll-scene-class")&&(g.sceneClass=a.getAttribute("data-scroll-scene-class"));if(a.hasAttribute("data-scroll-properties")){const l=a.getAttribute("data-scroll-properties");E("autoProperties")&&"false"==l||(g.properties=
l)}else E("autoProperties")&&(g.properties=!0);a.getAttribute("data-indicator-color")&&(g.indicatorColor=a.getAttribute("data-indicator-color"));a.hasAttribute("data-indicator-force")&&(g.addIndicators=!0);k.forEach(l=>{K(d,a,l,g)})});ScrollTrigger.refresh()}});window.HYPE_eventListeners.push({type:"HypeSceneUnload",callback:function(d,b){d=b.id;q[d]&&q[d].forEach(({id:e})=>{u.delete(e)});q[d]&&(q[d].forEach(({trigger:e})=>{e&&e.kill()}),q[d]=[]);ScrollTrigger.refresh()}});return{version:"1.0.1",
setDefault:function(d,b){"object"==typeof d?n=d:n[d]=b},getDefault:E,refresh:()=>{ScrollTrigger.refresh()},getTriggersForScene:d=>q[d]||[],debug:()=>({gsapVersion:gsap.version,scrollTriggerVersion:ScrollTrigger.version,triggers:q,scrollTriggers:ScrollTrigger.getAll(),timelineStates:u})}}console.error("\u274c HypeScrollTrigger: GSAP and ScrollTrigger are required but not available. Please include them before this script.")}());
